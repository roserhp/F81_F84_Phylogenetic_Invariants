#define the p-tildes
p1111, p1114, p1141, p1411, p4111, p1112, p1121, p1121, p1211, p2111, p4141, p4114, p4411, p1414, p1144, p2121, p2112, p2211, p1212, p1122, p4441, p4414, p4144, p1444, p2221, p2212, p2122, p1222 = var('p1111, p1114, p1141, p1411, p4111, p1112, p1121, p1121, p1211, p2111, p4141, p4114, p4411, p1414, p1144, p2121, p2112, p2211, p1212, p1122, p4441, p4414, p4144, p1444, p2221, p2212, p2122, p1222')
p4412, p4214, p1424, p1422, p2414, p2441, p4241, p4214, p2424, p3322, p2444, p4244, p3344, p3322, p2333, p3333 = var('p4412, p4214, p1424, p1422, p2414, p2441, p4241, p4214, p2424, p3322, p2444, p4244, p3344, p3322, p2333, p3333')
p1441, p1221, p1244, p1442 ,p4124, p4224, p4444, p4142, p2442, p4242, p4422, p2222, p2233, p2144, p2244, p4421= var('p1441, p1221, p1244, p1442, p4124, p4224, p4444, p4142, p2442, p4242, p4422, p2222, p2233, p2144, p2244, p4421')

#write the 38 equations
f1 = p1222*p1441 - p1221*p1422
f2 = p1222*p1414 - p1212*p1424
f3 = p1222*p1144 - p1122*p1244
f4 = p1144*p1414*p1441 - p1111*p1444^2
f5 = p1442*p1424*p1244 - p1222*p1444^2
f6 = p2212*p4411 - p2211*p4412
f7 = p2212*p4114 - p2112*p4214
f8 = p2212*p1414 - p1212*p2414
f9 = p1414*p4114*p4411 - p1111*p4414^2
f10 = p4412*p4214*p2414 - p2212*p4414^2
g1 = p1414*p4141 - p1441*p4114
g2 = p1414*p2441 - p1441*p2414
g3 = p1414*p4241 - p1441*p4214
g4 = p1414*p4441 - p1441*p4414
g5 = p1414*p4124 - p1424*p4114
g6 = p1414*p2424 - p1424*p2414
g7 = p1414*p4224 - p1424*p4214
g8 = p1414*p4444 - p1424*p4414
g9 = p1414*p4142 - p1442*p4114
g10 = p1414*p2442 - p1442*p2414
g11 = p1414*p4242 - p1442*p4214
g12 = p1414*p2444 - p1442*p4414
g13 = p1212*p4421 - p1221*p4412
g14 = p1212*p2221 - p1221*p2212
g15 = p1212*p2121 - p1221*p2112
h1 = matrix([[p1111, p1122, 0], [0, p1222, p1212], [p4411, p4422, p4412]]).determinant()
h2 = matrix([[p1111, p1122, 0], [0, p1222, p1212], [p2211, p2222, p2212]]).determinant()
h3 = matrix([[p1111, p1122, 0], [0, p1222, p1212], [0, p2122, p2112]]).determinant()
h4 = matrix([[p1111, p1122, 0], [0, p1222, p1212], [p4411, p3322, p4412]]).determinant()
i1 = matrix([[p1111, 0, p1144, 0], [0, p1212, p1244, 0], [0, 0, p1444, p1414], [p4411, p4412, p3344, 0]]).determinant()
i2 = matrix([[p1111, 0, p1144, 0], [0, p1212, p1244, 0], [0, 0, p1444, p1414], [p2211, p2212, p2233, 0]]).determinant()
i3 = matrix([[p1111, 0, p1144, 0], [0, p1212, p1244, 0], [0, 0, p1444, p1414], [p4411, p4412, p3333, p4414]]).determinant()
i4 = matrix([[p1111, 0, p1144, 0], [0, p1212, p1244, 0], [0, 0, p1444, p1414], [0, 0, p4144, p4114]]).determinant()
i5 = matrix([[p1111, 0, p1144, 0], [0, p1212, p1244, 0], [0, 0, p1444, p1414], [0, 0, p2444, p2414]]).determinant()
i6 = matrix([[p1111, 0, p1144, 0], [0, p1212, p1244, 0], [0, 0, p1444, p1414], [0, 0, p4244, p4214]]).determinant()
i7 = matrix([[p1111, 0, p1144, 0], [0, p1212, p1244, 0], [0, 0, p1444, p1414], [0, p2112, p2144, 0]]).determinant()
i8 =  matrix([[p1111, 0, p1144, 0], [0, p1414, p1444, 0], [0, 0, p1244, p1212], [p4411, p4414, p4444, p4412]]).determinant()
i9 =  matrix([[p1111, 0, p1144, 0], [0, p1414, p1444, 0], [0, 0, p1244, p1212], [p2211, 0, p2244, p2212]]).determinant()

#compute the Jacobian for a generic point
J(p1111, p1114, p1141, p1411, p4111, p1112, p1121, p1121, p1211, p2111, p4141, p4114, p4411, p1414, p1144, p2121, p2112, p2211, p1212, p1122, p4441, p4414, p4144, p1444, p2221, p2212, p2122, p1222,
             p4412, p4214, p1424, p1422, p2414, p2441, p4241, p4214, p2424, p3322, p2444, p4244, p3344, p3322, p2333, p3333,
             p1441, p1221, p1244, p1442 ,p4124, p4224, p4444, p4142, p2442, p4242, p4422, p2222, p2233, p2144, p2244, p4421)  = jacobian((f1,f2,f3,f4,f5,f6,f7,f8,f9,f10,g1,g2,g3,g4,g5,g6,g7,g8,g9,g10,g11,g12,g13,g14,g15,h1,h2,h3,h4,i1,i2,i3,i4,i5,i6,i7,i8,i9), 
             (p1111, p1114, p1141, p1411, p4111, p1112, p1121, p1121, p1211, p2111, p4141, p4114, p4411, p1414, p1144, p2121, p2112, p2211, p1212, p1122, p4441, p4414, p4144, p1444, p2221, p2212, p2122, p1222,
             p4412, p4214, p1424, p1422, p2414, p2441, p4241, p4214, p2424, p3322, p2444, p4244, p3344, p3322, p2333, p3333, 
             p1441, p1221, p1244, p1442 ,p4124, p4224, p4444, p4142, p2442, p4242, p4422, p2222, p2233, p2144, p2244, p4421))

#define the jacobian at the no-evolution point
nep = J(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)

#compute the rank of the Jacobian at the no evolution point
nep.rank()}
